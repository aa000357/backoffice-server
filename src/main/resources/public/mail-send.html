<!doctype html>
<html class="no-js" lang="">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>CodeC GM Tool首頁</title>
    <meta name="description" content="Ela Admin - HTML5 Admin Template">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- css 樣式 -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/themify-icons.css">
    <link rel="stylesheet" href="assets/css/flag-icon.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="//apps.bdimg.com/libs/jqueryui/1.10.4/css/jquery-ui.min.css">

    <!-- js 樣式 -->
    <script src="https://www.w3schools.com/lib/w3.js"></script>
    <script src="assets/js/vendor/jquery-2.1.4.min.js"></script>
    <script src="assets/js/plugins.js"></script>
    <script src="//apps.bdimg.com/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
    <script src="assets/js/util.js"></script>

    <!-- 日期時間選擇器 -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />



    <style>
        .display-flex {display: flex;}

        /* Popup container - can be anything you want */
    .popup {
    position: relative;
    display: inline-block;
    cursor: pointer;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    }

    /* The actual popup */
    .popup .popuptext {
    visibility: hidden;
    width: 160px;
    background-color: #555;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 8px 0;
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 50%;
    margin-left: -80px;
    }

    /* Popup arrow */
    .popup .popuptext::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: #555 transparent transparent transparent;
    }

    /* Toggle this class - hide and show the popup */
    .popup .show {
    visibility: visible;
    -webkit-animation: fadeIn 1s;
    animation: fadeIn 1s;
    }

    /* Add animation (fade in the popup) */
    @-webkit-keyframes fadeIn {
    from {opacity: 0;} 
    to {opacity: 1;}
    }

    @keyframes fadeIn {
    from {opacity: 0;}
    to {opacity:1 ;}
}
    </style>
</head>

<body>
    <!-- Left Panel -->
    <div w3-include-html="left.html"></div>
    <!-- <put-attribute name="topmenu" value="left.html" /> -->

    <!-- Right Panel -->
    <div id="right-panel" class="right-panel">

    <!-- Content -->
    <div class="content">
        <!-- Animated -->
        <div class="animated fadeIn">
            <!--信件編輯區-->
            <div class="col-lg-9">
                <div class="card">
                    <div class="card-header">
                        <strong>信件發送</strong>
                    </div>
                    <div class="card-body card-block">
                        <form action="#" method="post" enctype="multipart/form-data" class="form-horizontal">
                            <div class="row form-group">
                                <div class="col col-md-3"><label  class=" form-control-label">伺服器</label></div>
                                <div class="col-12 col-md-9">
                                    <select name="select" id="selectServ" class="form-control">
                                        <option value="0">台港澳</option>
                                        <option value="1" selected>測試服</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col col-md-3"><label  class=" form-control-label">玩家ID</label></div>
                                <div class="col-12 col-md-9"><input type="text" id="users" name="text-input" placeholder="玩家ID請用,間隔，請使用半形英文數字" class="form-control">
                                    <!-- <small class="form-text text-muted">This is a help text</small> -->
                                </div>
                            </div>

                            <div class="row form-group">
                                <div class="col col-md-3"><label class=" form-control-label">發送道具</label></div>
                                <div class="col-12 col-md-9" id = "open-item-list">
                                    <button class="btn btn-primary btn-sm" >
                                        <a style="color:#fff ;" href="#" onclick="window.open('item-type-list.html', '道具列表', config='height=800,width=1200');">開新視窗</a>
                                    </button>
                                </div>
                            </div>

                            <div class="row form-group">
                                <div class="col col-md-3"><label class=" form-control-label"></label></div>
                                    <div class = "table-stats col-md-9">
                                    <form action="#" method="post" class="form-inline ">

                                        <table class="table" >
                                            <thead>
                                            <tr>
                                                <th scope="col">道具ID</th>
                                                <th scope="col">道具名稱</th>
                                                <th scope="col">道具數量</th>
                                                <th scope="col"></th>
                                                <th scope="col"></th>
                                            </tr>
                                            </thead>
                                            <tbody id = "item_list">
                                            </tbody>
                                        </table>
                                    </form>
                                </div>
                            </div>

                            <div class="row form-group">
                                <div class="col col-md-3"><label class=" form-control-label">標題</label></div>
                                <div class="col-12 col-md-9"><input type="text" name="text-input" placeholder="" class="form-control" id = "caption"></div>
                            </div>
                            <div class="row form-group">
                                <div class="col col-md-3"><label class=" form-control-label">寄件人</label></div>
                                <div class="col-12 col-md-9">
                                    <select name="select" id="sender_list" class="form-control">

                                    </select>
                                </div>
                            </div>

                            <div class="row form-group">
                                <div class="col col-md-3"><label class=" form-control-label">內文</label></div>
                                <div class="col-12 col-md-9"><textarea name="textarea-input" id="mailNote" rows="9" placeholder="" class="form-control"></textarea></div>
                            </div>

                            <div class="row form-group">
                                <div class="col col-md-3"><label class=" form-control-label">發送時間</label></div>

                                <div class="col-12 col-md-3">
                                    <input class="form-control" type="text" name="sendtimes" id="send-time" />
                                </div>
                            </div>

                            <div class="row form-group ">
                                <div class="col col-md-3"><label class=" form-control-label">領取時限</label></div>
                                <div class="col-12 col-md-5 display-flex">
                                    <input class="form-control" type="text" name="expiredtimes" id="expired-time"/>

                                    <div class="col col-md-3"><label class=" form-control-label">永久</label></div>

                                    <!-- <label  class="form-control-label">永久</label> -->
                                    <div class="form-check-inline form-check ">
                                        <label  class="form-check-label display-flex">
                                            <input type="checkbox" id="forever-checkbox" name="inline-checkbox1" value="option1" class="form-check-input">
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="card-body">
                                <button id = "preview" style="float:right" type="button" class="btn btn-primary btn-sm" onclick="gopreview()">預覽</button>
                                <button id = "save" style="float:right" type="button" class="btn btn-primary btn-sm" onclick="doSave()" hidden="hidden">發送</button>
                                <label style="float:right" class=" form-control-label">&emsp;</label>
                                <button id = "modify" style="float:right" type="button" class="btn btn-primary btn-sm" onclick="gomodify()" hidden="hidden">修改</button>
                            </div>
                        </form>
                    </div>


                </div>
            </div>
        </div>
        <!-- .animated -->
    </div>
    <!-- /.content -->
    <div class="clearfix"></div>
    <script>w3.includeHTML();</script>
    <!-- 日期時間選擇器 -->
    <script>
    $(function() {
      $('input[name="sendtimes"]').daterangepicker({
        singleDatePicker:true,
        timePicker: true,
        startDate: moment().startOf(),
        locale: {
          format: 'YYYY/MM/DD HH:mm'
        }
      });

      $('input[name="expiredtimes"]').daterangepicker({
        singleDatePicker:true,
        timePicker: true,
        startDate: moment().add(1, 'year'),
        locale: {
          format: 'YYYY/MM/DD HH:mm'
        }
      });
    });

    function genOption(data){
        for(let i = 0 ; i < data.length ; i++) {
            $('#sender_list').append("<option value='" + data[i].senderId + "'>" + data[i].senderZhTw + "</option>");
        }
    }
        send("/sender", "GET", {}, genOption);

<!--    預覽-->
    function gopreview(){
        document.getElementById("selectServ").disabled = true;
        document.getElementById("users").disabled = true;
        document.getElementById("open-item-list").hidden = true;
        document.getElementById("caption").readOnly = true;
        document.getElementById("sender_list").disabled = true;
        document.getElementById("mailNote").readOnly = true;
        document.getElementById("send-time").readOnly = true;
        document.getElementById("expired-time").readOnly = true;
        document.getElementById("forever-checkbox").disabled = true;

        $('.item-count').attr("readonly",true);
        $('.ti-trash').attr("hidden","hidden");

        $('#preview').attr("hidden","hidden");
        $('#save').removeAttr("hidden");
        $('#modify').removeAttr("hidden");
    }

<!--    修改-->
    function gomodify(){
        document.getElementById("selectServ").disabled = false;
        document.getElementById("users").disabled = false;
        document.getElementById("open-item-list").hidden = false;
        document.getElementById("caption").readOnly = false;
        document.getElementById("sender_list").disabled = false;
        document.getElementById("mailNote").readOnly = false;
        document.getElementById("send-time").readOnly = false;
        document.getElementById("expired-time").readOnly = false;
        document.getElementById("forever-checkbox").disabled = false;

        $('.item-count').removeAttr("readonly");
        $('.ti-trash').removeAttr("hidden");

        $('#preview').removeAttr("hidden");
        $('#save').attr("hidden","hidden");
        $('#modify').attr("hidden","hidden");
    }

    function doSave(){
    let sendTime = $('#send-time').val() ;
    let expiredTime = $('#expired-time').val();
        var param = {
            "users": "ffff",
            "sender": "金幣(遊戲幣)",
            "mailName": "ffff",
            "mailNote": "eeeeeeeeeeeeeeeeeeeeeeeeeeeeffffddd",
            "sendTime": "2023/01/07 13:58",
            "expiredTime": "2023/01/07 13:58"
        };

        $.ajax({
            type : 'POST',
            url : "/mail/newmailtemplate",
            async: false,
            data :  param,
            dataType: 'json',
            success : function (data){
                alert(data);
            },
            error: function (){
                alert("false");
            }
        })
    }

    </script>
    </body>
</html>
